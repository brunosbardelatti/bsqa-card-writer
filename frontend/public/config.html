<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‚öôÔ∏è Configura√ß√µes - BSQA Card Writer</title>
  
  <!-- Preload de componentes cr√≠ticos (REFACT.md - FASE 3) -->
  <link rel="preload" href="components/header.html" as="fetch" crossorigin>
  <link rel="preload" href="components/footer.html" as="fetch" crossorigin>
  
  <link rel="stylesheet" href="assets/style.css">
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
</head>
<body>
  <div id="header" data-testid="config-header-container"></div>
  <div class="skeleton skeleton-header"></div>
  <div class="container" data-testid="config-main-container">
    <!-- Breadcrumbs -->
    <div class="breadcrumbs" data-testid="config-breadcrumbs-container">
      <!-- Breadcrumbs ser√£o preenchidos dinamicamente -->
    </div>
    
    <h1 data-testid="config-title">‚öôÔ∏è Configura√ß√µes do Usu√°rio</h1>
    <div class="config-section" data-testid="config-section-personal-info">
      <h2 data-testid="config-section-personal-info-title">üë§ Informa√ß√µes Pessoais</h2>
      <div class="config-item" data-testid="config-item-user-name">
        <label for="userName" data-testid="config-label-user-name">Nome do Usu√°rio <span title="Seu nome completo para identifica√ß√£o nos documentos gerados" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <input type="text" id="userName" placeholder="Seu nome completo" data-testid="config-input-user-name">
      </div>
      <div class="config-item" data-testid="config-item-user-email">
        <label for="userEmail" data-testid="config-label-user-email">Email <span title="Seu email para contato e identifica√ß√£o" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <input type="email" id="userEmail" placeholder="seu@email.com" data-testid="config-input-user-email">
      </div>
      <div class="config-item" data-testid="config-item-user-company">
        <label for="userCompany" data-testid="config-label-user-company">Empresa <span title="Nome da sua empresa para personaliza√ß√£o dos documentos" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <input type="text" id="userCompany" placeholder="Nome da empresa" data-testid="config-input-user-company">
      </div>
    </div>
    <div class="config-section" data-testid="config-section-preferences">
      <h2 data-testid="config-section-preferences-title">üìã Prefer√™ncias de Sa√≠da</h2>
      <div class="checkbox-item">
        <input type="checkbox" id="autoCopy" data-testid="config-checkbox-auto-copy">
        <label for="autoCopy">Copiar resultado automaticamente <span title="Copia automaticamente o resultado para a √°rea de transfer√™ncia ap√≥s a gera√ß√£o" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="clearAfterSuccess" checked data-testid="config-checkbox-clear-after-success">
        <label for="clearAfterSuccess">Limpar campos ap√≥s sucesso <span title="Limpa automaticamente os campos de entrada ap√≥s gerar uma resposta com sucesso" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
      </div>
      <div class="checkbox-item disabled">
        <input type="checkbox" id="showHistory" disabled data-testid="config-checkbox-show-history">
        <label for="showHistory" title="Funcionalidade em desenvolvimento - Em breve dispon√≠vel">Mostrar hist√≥rico de an√°lises <span title="Permite visualizar e reutilizar an√°lises anteriores (funcionalidade em desenvolvimento)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <span style="color: var(--muted-text); font-size: 0.8em; margin-left: 0.5rem;">(Em desenvolvimento)</span>
      </div>
    </div>
    <div class="config-section" data-testid="config-section-interface">
      <h2 data-testid="config-section-interface-title">üé® Configura√ß√µes de Interface</h2>
      <div class="config-item" data-testid="config-item-theme">
        <label for="theme" data-testid="config-label-theme">Tema <span title="Escolha entre tema escuro, claro ou autom√°tico baseado nas configura√ß√µes do sistema" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <select id="theme" data-testid="config-select-theme">
          <option value="dark" data-testid="config-option-theme-dark">Escuro (Padr√£o)</option>
          <option value="light" data-testid="config-option-theme-light">Claro</option>
          <option value="auto" data-testid="config-option-theme-auto">Autom√°tico</option>
        </select>
      </div>
    </div>
    <div class="config-section" id="jira-config" data-testid="config-section-jira">
      <h2 data-testid="config-section-jira-title">üé´ Configura√ß√µes do Jira</h2>
      <fieldset style="border: 2px solid #ff9800; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;" data-testid="config-fieldset-jira">
        <legend style="color: #ff9800; font-weight: bold; padding: 0 0.5rem;" data-testid="config-legend-jira">Jira Cloud API</legend>
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <label>üîë Configura√ß√µes do Jira <span title="Configura√ß√µes necess√°rias para integra√ß√£o com Jira" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <div style="display: flex; align-items: center;">
            <input type="checkbox" id="jiraEnabled" style="margin-right: 0.5rem;" data-testid="config-checkbox-jira-enabled">
            <label for="jiraEnabled" style="margin: 0; font-size: 0.9em;">Habilitar Jira</label>
          </div>
        </div>
        <div class="config-item">
          <label for="jiraBaseUrl">URL Base do Jira <span title="URL da sua inst√¢ncia Jira Cloud (ex: https://empresa.atlassian.net)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="jiraBaseUrl" placeholder="https://sua-empresa.atlassian.net" disabled data-testid="config-input-jira-base-url">
        </div>
        <div class="config-item">
          <label for="jiraUserEmail">Email do Usu√°rio <span title="Email da conta Jira que ser√° usada para autentica√ß√£o" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="email" id="jiraUserEmail" placeholder="seu@email.com" disabled data-testid="config-input-jira-user-email">
        </div>
        <div class="config-item">
          <label for="jiraApiToken">API Token <span title="Token de API do Jira (gere em: Configura√ß√µes ‚Üí Seguran√ßa ‚Üí API tokens)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="password" id="jiraApiToken" placeholder="Seu API Token do Jira" disabled data-testid="config-input-jira-api-token">
        </div>
        <div class="config-item">
          <label for="jiraSubtaskIssueTypeId">ID do Tipo de Issue Subtask <span title="ID do tipo de issue para subtasks (geralmente 10003 ou 10004)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="jiraSubtaskIssueTypeId" placeholder="10003" disabled data-testid="config-input-jira-subtask-issue-type-id">
        </div>
        <div class="config-item">
          <label for="jiraRequestTimeout">Timeout de Requisi√ß√£o (segundos) <span title="Tempo m√°ximo de espera para requisi√ß√µes ao Jira (padr√£o: 30 segundos)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="number" id="jiraRequestTimeout" placeholder="30" value="30" disabled data-testid="config-input-jira-request-timeout">
        </div>
      </fieldset>
      <!-- Bot√£o de teste Jira -->
      <div class="config-item" style="margin-top: 1rem;">
        <div style="display: flex; gap: 1rem; justify-content: center;">
          <button onclick="testJiraConnection()" class="primary-btn" style="width: 200px; font-size: 0.9em;" data-testid="config-button-test-jira-connection">
            üß™ Testar conex√£o Jira
          </button>
        </div>
        <div id="testJiraResult" style="margin-top: 0.5rem; padding: 0.5rem; border-radius: 4px; display: none;" data-testid="config-test-jira-result-container"></div>
      </div>
    </div>
    <div class="config-section" id="ai-config" data-testid="config-section-ai">
      <h2 data-testid="config-section-ai-title">ü§ñ Configura√ß√µes de IA</h2>
              <div class="config-item" id="template-config" data-testid="config-item-default-analysis-type">
          <label for="defaultAnalyseType" data-testid="config-label-default-analysis-type">Tipo de An√°lise Padr√£o <span title="Selecione o tipo de an√°lise que ser√° usado por padr√£o" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <select id="defaultAnalyseType" data-testid="config-select-default-analysis-type">
            <option value="">Carregando tipos de an√°lise...</option>
          </select>
        </div>
      <div class="config-item" data-testid="config-item-default-ai">
        <label for="defaultAI" data-testid="config-label-default-ai">IA Padr√£o <span title="Selecione qual IA ser√° usada por padr√£o: OpenAI ou StackSpot AI" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
        <select id="defaultAI" data-testid="config-select-default-ai">
          <option value="openai" data-testid="config-option-default-ai-openai">OpenAI</option>
          <option value="stackspot" data-testid="config-option-default-ai-stackspot">StackSpot AI</option>
        </select>
        <div id="defaultAIWarning" style="display:none; color: #f44336; font-size: 0.95em; margin-top: 0.5rem;" data-testid="config-warning-default-ai"></div>
      </div>
      <fieldset style="border: 2px solid #4caf50; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;" data-testid="config-fieldset-openai">
        <legend style="color: #4caf50; font-weight: bold; padding: 0 0.5rem;" data-testid="config-legend-openai">OpenAI</legend>
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <label>üîë Configura√ß√µes OpenAI <span title="Configura√ß√µes necess√°rias para usar a OpenAI" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <div style="display: flex; align-items: center;">
            <input type="checkbox" id="openaiEnabled" style="margin-right: 0.5rem;" data-testid="config-checkbox-openai-enabled">
            <label for="openaiEnabled" style="margin: 0; font-size: 0.9em;">Habilitar OpenAI</label>
          </div>
        </div>
        <div class="config-item">
          <label for="openaiApiKey">API Key <span title="Sua chave de API da OpenAI (obrigat√≥rio para usar OpenAI)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="password" id="openaiApiKey" placeholder="sk-..." disabled data-testid="config-input-openai-api-key">
        </div>
        <div class="config-item">
          <label for="maxTokens">M√°ximo de Tokens <span title="N√∫mero m√°ximo de tokens para gerar a resposta. Valores maiores geram respostas mais detalhadas" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="maxTokens" placeholder="1000" value="1000" data-testid="config-input-max-tokens">
        </div>
      </fieldset>
      <fieldset style="border: 2px solid #2196f3; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;" data-testid="config-fieldset-stackspot">
        <legend style="color: #2196f3; font-weight: bold; padding: 0 0.5rem;" data-testid="config-legend-stackspot">StackSpot AI</legend>
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <label>üîë Configura√ß√µes StackSpot AI <span title="Configura√ß√µes necess√°rias para usar o StackSpot AI" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <div style="display: flex; align-items: center;">
            <input type="checkbox" id="stackspotEnabled" style="margin-right: 0.5rem;" data-testid="config-checkbox-stackspot-enabled">
            <label for="stackspotEnabled" style="margin: 0; font-size: 0.9em;">Habilitar StackSpot AI</label>
          </div>
        </div>
        <div class="config-item">
          <label for="stackspotClientId">Client ID <span title="ID do cliente StackSpot (obrigat√≥rio)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="stackspotClientId" placeholder="seu-client-id" disabled data-testid="config-input-stackspot-client-id">
        </div>
        <div class="config-item">
          <label for="stackspotClientSecret">Client Secret <span title="Chave secreta do cliente StackSpot (obrigat√≥rio)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="password" id="stackspotClientSecret" placeholder="seu-client-secret" disabled data-testid="config-input-stackspot-client-secret">
        </div>
        <div class="config-item">
          <label for="stackspotRealm">Realm <span title="Realm do StackSpot (obrigat√≥rio)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="stackspotRealm" placeholder="seu-realm" disabled data-testid="config-input-stackspot-realm">
        </div>
        <div class="config-item">
          <label for="stackspotAgentId">Agent ID <span title="ID do agente StackSpot (obrigat√≥rio)" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <input type="text" id="stackspotAgentId" placeholder="seu-agent-id" disabled data-testid="config-input-stackspot-agent-id">
        </div>
        <div class="config-item">
          <label>Configura√ß√µes StackSpot AI <span title="Configura√ß√µes espec√≠ficas para o StackSpot AI" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          <div class="checkbox-item">
            <input type="checkbox" id="streaming" data-testid="config-checkbox-streaming">
            <label for="streaming">Streaming (resposta em tempo real) <span title="Ativa o modo streaming para receber respostas em tempo real do StackSpot AI" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="stackspotKnowledge" data-testid="config-checkbox-stackspot-knowledge">
            <label for="stackspotKnowledge">Usar conhecimento StackSpot <span title="Utiliza o conhecimento espec√≠fico do StackSpot para melhorar as respostas" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="returnKsInResponse" data-testid="config-checkbox-return-ks">
            <label for="returnKsInResponse">Retornar KS na resposta <span title="Inclui informa√ß√µes do Knowledge Source (KS) na resposta gerada" style="color: var(--accent-color); cursor: help;">‚ÑπÔ∏è</span></label>
          </div>
        </div>
      </fieldset>
      <!-- Bot√µes de a√ß√£o -->
      <div class="config-item" style="margin-top: 1rem;">
        <div style="display: flex; gap: 1rem; justify-content: center;">
          <button onclick="testApiConfig()" class="primary-btn" style="width: 200px; font-size: 0.9em;" data-testid="config-button-test-connection">
            üß™ Testar conex√£o com IA
          </button>
          <button class="save-btn" id="saveBtn" style="width: 200px;" data-testid="config-button-save-settings">üíæ Salvar Configura√ß√µes</button>
        </div>
        <div id="testResult" style="margin-top: 0.5rem; padding: 0.5rem; border-radius: 4px; display: none;" data-testid="config-test-result-container"></div>
      </div>
    </div>
    <div id="statusMessage" class="status-message" data-testid="config-status-message"></div>
  </div>
  <div id="modal" data-testid="config-modal-container"></div>
  <div id="footer" data-testid="config-footer-container"></div>
  <div class="skeleton skeleton-footer"></div>
  <script src="js/apiConfig.js"></script>
  <script type="module" src="js/main.js"></script>
  <script src="js/apiConfig.js"></script>
<script type="module" src="js/config.js"></script>
</body>
</html> 